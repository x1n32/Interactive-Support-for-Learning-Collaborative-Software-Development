#!/usr/bin/env python
#File Appending to check the checkboxes
import sys

print ("Starting commit-msg hook")




newFileReplacement = ""
scoreFind = "You have passed"
scoreIndex = 1

#Finding score from report page 
file = open("calculator2Report.md", "r")
for line in file:
    line = line.strip()
    if scoreFind in line:
        score = line[-17];
        break;
    scoreIndex += 1

file.close()
print(scoreIndex , "The number found: " , score)


#The report file
file = open("Task1.md", "r")
startline = 99999
foundLine = False
string1 = "Main Task:"
#using the for loop to find the line where it displays the tasks
for line in file:
    line = line.strip()
    #Change while the line read is under the score value
    #If user got 4 test passed, reads 4 lines from where the first - [ is
    if string1 in line:
        if foundLine == False:
            startline = 1 - 2 #This is hard coded.. Main Task: ;another line; next line has -[ ]
            foundLine = True
        if startline <= int(score):
            startline += 1
            changes = line.replace("- [ ]", "- [x]")
            newFileReplacement = newFileReplacement + changes + "\n"
        else : 
            newFileReplacement = newFileReplacement + line + "\n"
    else : 
        newFileReplacement = newFileReplacement + line + "\n"


file.close()
# opening the file in write mode

fout = open("calculator1Report.md", "w")
fout.write(newFileReplacement)
fout.close()


#--------------------------------------------------------------
#Task 2 file 

checkbox1 = False #Corresponds to each of the checkboxes/tasks
checkbox2 = False
checkbox3 = False

lineToFind1 = "Challenge 1: Replacing empty values(find and replace empty value method) WORKS!"
lineToFind2 = "Challenge 1.2: null values replaced (find and replace empty value method) WORKS!"
lineToFind3 = "Challenge 2: Creating a new hash map(createNewHashMap) WORKS!"

# Reading file to see if test passed
file = open("HashMapReport.md", "r")
for line in file:
    line = line.strip()
    if lineToFind in line:
        checkbox1 = True
    if lineToFind in line:
        checkbox2 = True
    if lineToFind in line:
        checkbox3 = True
print("checkbox status", checkbox1,checkbox2,checkbox3)
file.close()

#Append to file:
file = open("Task2.md", "r")
#using the for loop to find the line where it displays the tasks
for line in file:
    line = line.strip()
    if (lineToFind1 == True):
        changeline = line.replace("- [ ] Challenge 1:", "- [x] Challenge 1:")
    if (lineToFind2 == True):
        changeline = line.replace("- [ ] Challenge 1.2:", "- [x] Challenge 1.2:")
    if (lineToFind3 == True):
        changeline = line.replace("- [ ] Challenge 2:", "- [x] Challenge 2:")
    newFile = newFile + changeline + "\n"
file.close()

#Write to file 
fout = open("calculator1Report.md", "w")
fout.write(newFile)
fout.close()

sys.exit(0) #0 indicates success



